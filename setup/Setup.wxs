<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <?include $(sys.CURRENTDIR)Includes\Variables.wxi ?>

  <!-- Major Upgrade: https://www.firegiant.com/wix/tutorial/upgrades-and-modularization/replacing-ourselves/ -->
  <!-- Change Id & Version on Major Upgrades --><!-- Changing a Component's GUID requires a Major Upgrade -->
  <!-- Change Version on Minor Upgrades -->
  <Product Id="FB922421-E38D-4BF7-BAEC-BC5DB822A8E5" Name="Timma" Language="1033" Version="1.4.1.0" Manufacturer="Timma" UpgradeCode="dced035b-2e9a-4337-9976-d0684aefbad0">
    
    <!-- The Id attribute (PackageId) will be automatically generated by Wix -->
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    
		<MajorUpgrade DowngradeErrorMessage="A newer version of Timma is already installed." />
		<MediaTemplate />
    
    <Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
        <Directory Id="APPLICATION_ROOT_DIRECTORY" Name="Timma">
          <Directory Id="LOCALES_DIRECTORY" Name="locales" />
        </Directory>
      </Directory>
      <Directory Id="DesktopFolder" />
      <Directory Id="ProgramMenuFolder" />
		</Directory>

    <Icon Id="Timma.ico" SourceFile="Gfx\Timma.ico" />

		<Feature Id="ProgFiles" Title="Timma" Level="1">
			<ComponentGroupRef Id="RootFiles" />
      <ComponentGroupRef Id="Locales" />
      <ComponentRef Id="ApplicationDesktopShortcutComp" />
      <ComponentRef Id="ApplicationStartMenuShortcutComp" />
		</Feature>

    <Property Id="ARPPRODUCTICON" Value="Timma.ico" />
    <Property Id="WIXUI_INSTALLDIR" Value="APPLICATION_ROOT_DIRECTORY" />

    <UIRef Id="WixUI_InstallDir" />
  
    <WixVariable Id="WixUIBannerBmp" Value="Gfx\top_banner.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="Gfx\background.bmp" />
    <WixVariable Id="WixUILicenseRtf" Value="LICENSE.rtf" />

    <Property Id="SignOutput" Value="true" />
  </Product>

  <Fragment>
    <DirectoryRef Id="DesktopFolder">
      <Component Id="ApplicationDesktopShortcutComp" Guid="9EFD060B-7050-451F-B9FF-380DD4CC8F3C">
        <Shortcut Id="ApplicationDesktopShortcut"
                  Name="Timma"
                  Description="Launch Timma"
                  Target="[#Timma.exe]"
                  WorkingDirectory="APPLICATION_ROOT_DIRECTORY"
                  Icon="Timma.ico" />
        <RemoveFile Id="ApplicationDesktopShortcut" Name="Timma" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\Microsoft\Timma" Name="installedDesktopSC" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>
    
    <DirectoryRef Id="ProgramMenuFolder">
      <Component Id="ApplicationStartMenuShortcutComp" Guid="E286A628-8CE2-4047-806D-F96323DD3871">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Timma"
                  Description="Launch Timma"
                  Target="[#Timma.exe]"
                  WorkingDirectory="APPLICATION_ROOT_DIRECTORY"
                  Icon="Timma.ico" />
        <RemoveFile Id="ApplicationStartMenuShortcut" Name="Timma" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\Microsoft\Timma" Name="installedStartMenuSC" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>
  </Fragment>

</Wix>
