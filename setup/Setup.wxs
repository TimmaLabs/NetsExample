<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <?include $(sys.CURRENTDIR)Includes\Variables.wxi ?>

  <!-- Major Upgrade: https://www.firegiant.com/wix/tutorial/upgrades-and-modularization/replacing-ourselves/ -->
  <!-- Change Id & Version on Major Upgrades --><!-- Changing a Component's GUID requires a Major Upgrade -->
  <!-- Change Version on Minor Upgrades -->
  <Product Id="768AD5FB-F9DF-494B-AFB2-08F094028737" Name="NetsExample" Language="1033" Version="1.0.2.0" Manufacturer="Nets" UpgradeCode="D4D01BE0-53EB-4282-AC1F-80475829B70F">
    
    <!-- The Id attribute (PackageId) will be automatically generated by Wix -->
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    
		<MajorUpgrade DowngradeErrorMessage="A newer version of NetsExample is already installed." />
		<MediaTemplate />
    
    <Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
        <Directory Id="APPLICATION_ROOT_DIRECTORY" Name="NetsExample">
          <Directory Id="LOCALES_DIRECTORY" Name="locales" />
        </Directory>
      </Directory>
      <Directory Id="DesktopFolder" />
      <Directory Id="ProgramMenuFolder" />
		</Directory>

    <Icon Id="Nets.ico" SourceFile="Gfx\Nets.ico" />

		<Feature Id="ProgFiles" Title="Nets" Level="1">
			<ComponentGroupRef Id="RootFiles" />
      <ComponentGroupRef Id="Locales" />
      <ComponentRef Id="ApplicationDesktopShortcutComp" />
      <ComponentRef Id="ApplicationStartMenuShortcutComp" />
		</Feature>

    <Property Id="ARPPRODUCTICON" Value="Nets.ico" />
    <Property Id="WIXUI_INSTALLDIR" Value="APPLICATION_ROOT_DIRECTORY" />

    <UIRef Id="WixUI_InstallDir" />
  
    <WixVariable Id="WixUIBannerBmp" Value="Gfx\top_banner.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="Gfx\background.bmp" />
    <WixVariable Id="WixUILicenseRtf" Value="LICENSE.rtf" />

    <Property Id="SignOutput" Value="true" />
  </Product>

  <Fragment>
    <DirectoryRef Id="DesktopFolder">
      <Component Id="ApplicationDesktopShortcutComp" Guid="9EFD060B-7050-451F-B9FF-380DD4CC8F3C">
        <Shortcut Id="ApplicationDesktopShortcut"
                  Name="NetsExample"
                  Description="Launch NetsExample"
                  Target="[#NetsExample.exe]"
                  WorkingDirectory="APPLICATION_ROOT_DIRECTORY"
                  Icon="Nets.ico" />
        <RemoveFile Id="ApplicationDesktopShortcut" Name="NetsExample" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\Microsoft\NetsExample" Name="installedDesktopSC" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>
    
    <DirectoryRef Id="ProgramMenuFolder">
      <Component Id="ApplicationStartMenuShortcutComp" Guid="E286A628-8CE2-4047-806D-F96323DD3871">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="NetsExample"
                  Description="Launch NetsExample"
                  Target="[#NetsExample.exe]"
                  WorkingDirectory="APPLICATION_ROOT_DIRECTORY"
                  Icon="Nets.ico" />
        <RemoveFile Id="ApplicationStartMenuShortcut" Name="NetsExample" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\Microsoft\NetsExample" Name="installedStartMenuSC" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </DirectoryRef>
  </Fragment>

</Wix>
